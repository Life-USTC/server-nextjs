# E2E 覆盖度对照（页面功能级）

本文件用于回答两个问题：

- `src/app/**/page.tsx` 的页面路由是否都有对应 E2E：是（已全覆盖）。
- 每个页面里“用户能点的按钮/能提交的表单/能切换的 Tab”等关键功能是否都被测到：不完全（见下方缺口清单）。

## 总结

- 路由覆盖：页面路由与 API Route Handlers 均已存在对应 E2E 用例。
- 功能覆盖：大部分页面目前属于“可打开 + 关键文本/重定向 + 少量点击”的 smoke 级覆盖；涉及复杂交互的页面（上传、批量导入、作业面板、管理员工具、资料编辑、账号删除等）存在较多未覆盖关键路径。

## 页面覆盖矩阵（按路由）

说明：

- ✅：已覆盖
- ◑：部分覆盖（存在关键未测路径）
- ☐：未覆盖

| 路由 | 页面可访问/404 | 未登录重定向 | 核心交互（表单/按钮/菜单） | 备注 |
|---|---:|---:|---:|---|
| `/` | ✅ | ☐ | ◑ | 主题切换已测；管理员入口/外链未测 |
| `/signin` | ✅ | ☐ | ◑ | dev 调试登录已测；callbackUrl/error/已登录重定向未测 |
| `/dashboard` | ✅ | ✅ | ◑ | 仅测作业入口跳转；时间线/周表/调试卡等未测 |
| `/dashboard/homeworks` | ✅ | ✅ | ◑ | 可创建作业已测；完成切换/筛选结果/跳转详情未测 |
| `/dashboard/comments` | ✅ | ✅ | ◑ | 可跳原文已测（弱断言）；分页/面包屑未测 |
| `/dashboard/uploads` | ✅ | ✅ | ✅ | 上传/复制链接/打开/确认删除/重命名等主流程已测 |
| `/dashboard/subscriptions/sections` | ✅ | ✅ | ◑ | 复制 iCal、批量导入（取消/确认）已测；日历组件交互未测 |
| `/sections` | ✅ | ☐ | ◑ | 列表进详情与搜索帮助/清除筛选已测；分页与更多筛选未测 |
| `/sections/[jwId]` | ✅ | ☐ | ◑ | 评论发/改/回/点赞已测；作业面板/日历订阅/描述编辑等未测；评论删除未测 |
| `/teachers` | ✅ | ☐ | ◑ | 列表进详情已测；筛选器/分页未测 |
| `/teachers/[id]` | ✅ | ☐ | ◑ | 404/面包屑已测；点击班级/评论交互/描述编辑未测 |
| `/courses` | ✅ | ☐ | ◑ | 语言切换与进详情已测；筛选器/分页/清空未测 |
| `/courses/[jwId]` | ✅ | ☐ | ◑ | Tab/面包屑已测；点击班级/评论交互/描述编辑未测 |
| `/comments/guide` | ✅ | ☐ | ✅ | 基本静态页 |
| `/comments/[id]` | ✅ | ☐ | ✅ | 主要为重定向逻辑 |
| `/api-docs` | ✅ | ☐ | ◑ | 仅测 Swagger UI 渲染关键文本；Try it out 等未测 |
| `/settings` | ✅ | ✅ | ✅ | 重定向到 profile 已测 |
| `/settings/profile` | ✅ | ✅ | ◑ | 初始值与保存/回滚已测；头像选择等未测 |
| `/settings/uploads` | ✅ | ✅ | ✅ | 重定向到 dashboard/uploads 已测 |
| `/settings/comments` | ✅ | ✅ | ✅ | 重定向到 dashboard/comments 已测 |
| `/settings/content` | ✅ | ✅ | ✅ | 两个入口点击跳转已测 |
| `/settings/accounts` | ✅ | ✅ | ◑ | “连接”跳 OAuth 与“仅剩一个账户时断开禁用提示”已测；解绑主流程未测 |
| `/settings/danger` | ✅ | ✅ | ◑ | 输入 DELETE 启用确认按钮 + 取消关闭已测；真实删除不测（破坏性） |
| `/admin` | ✅ | ✅ | ✅ | 普通用户 404/管理员入口点击已测 |
| `/admin/users` | ✅ | ✅ | ◑ | 搜索过滤与编辑保存已测；封禁创建/分页未测 |
| `/admin/moderation` | ✅ | ✅ | ◑ | 评论弹窗切换/更新状态与备注/解除封禁已测；筛选与跳原文未测 |
| `/u/[username]` | ✅ | ☐ | ✅ | 展示为主 |
| `/u/id/[uid]` | ✅ | ☐ | ✅ | 展示为主 |

## 关键缺口（建议优先补测）

按“用户高频 + 风险高 + 交互复杂”排序：

1. 订阅日历交互（`/dashboard/subscriptions/sections`）
   - 日历组件：切月/点击事件打开详情的最短路径
2. 内容页互动（`/courses`、`/teachers`、`/sections`）
   - 分页与多维筛选的最短路径（选择筛选 → URL 参数变化 → 列表变化）
3. 管理员工具补全（`/admin/users`、`/admin/moderation`）
   - /admin/users：封禁创建（含 custom 时间分支）
   - /admin/moderation：筛选与“跳转原文”分支
4. 账号关联（`/settings/accounts`）
   - 多账户时解绑主流程（打开确认弹窗 → 取消/确认 → toast/状态变化）

## 说明

- 本覆盖对照是“页面功能级”静态对比：根据页面/关键组件里存在的按钮、表单、Tab、菜单等交互点与当前 E2E 断言/点击路径做差分。
- 对第三方渲染的页面（`/api-docs` Swagger UI），建议只做“关键渲染 + 关键交互一条最短路径”，避免不稳定。

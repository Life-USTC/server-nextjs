# 文档编写与更新规范

## 适用范围
- 适用于仓库根目录 `AGENTS.md` 与 `docs/**/*.md`。
- 适用于功能开发、重构、接口变更、测试策略调整等所有会改变行为或约定的改动。

## 规则清单

### 单一事实来源
- 项目约定优先写在 `docs/` 与 `AGENTS.md`，不要仅写在 PR 描述或临时聊天记录。
- 同一规则只保留一个主位置，其他文档通过链接或简短引用指向主位置。

### 文档分层
- `AGENTS.md`：项目级工作约束、技能加载、验证要求与高优先级规则。
- `docs/README.md`：文档导航与维护规则。
- 主题文档（如 API、Prisma、测试）：记录可执行规则与示例。
- 清单文档（如 `docs/urls.md`）：记录需要同步维护的索引信息。

### 结构模板
- 约定类文档优先使用固定结构：`适用范围` → `规则清单` → `示例` → `更新触发`。
- 设计说明类文档可保留“现状/优化/后续建议”，但仍应补充 `适用范围` 与 `更新触发`。

### 可执行性
- 规则必须可落地，优先写“做什么 + 在哪里做 + 用什么命令验证”。
- 命令与脚本名必须与 `package.json` 保持一致。
- 文档中的路径、函数名、路由名必须可在仓库中定位。

### 一致性
- 语言、术语、状态码、命名风格在全仓库文档中保持一致。
- 更新一个规则时，同时检查相关文档是否存在重复或冲突并一并修正。

## 示例
- 新增页面 `/foo`：同步更新 `docs/urls.md`，并在相关专题文档补充该页面涉及的约定。
- 新增 API `POST /api/bar`：同步更新 API 规范文档、OpenAPI 产物说明与测试文档覆盖项。
- 修改校验策略：在 API/Prisma 文档中统一替换旧写法，避免出现新旧规则并存。

## 更新触发
- 新增/删除页面、路由重定向或动态路由参数变化。
- 新增/调整 API 契约、错误码、鉴权策略、输入校验方案。
- 调整测试策略、CI 验证链路或本地开发命令。
- 发现文档间冲突、过期说明或不可执行指引。
